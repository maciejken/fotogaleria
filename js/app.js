$(function() {
  var body, closeBtn, figures, header, i, image, images, len, loaders, menuBtn, navMenu, popup, popupFig, popupImg, popupNav, showBtn, showImg;
  body = $('body');
  header = $('header');
  menuBtn = header.find('.icon-arrow-down');
  navMenu = $('nav.menu');
  menuBtn.on('click', function() {
    return navMenu.slideToggle(500, (function(_this) {
      return function() {
        if (navMenu.is(':visible')) {
          $(_this).toggleClass('icon-arrow-up');
          return $(_this).toggleClass('icon-arrow-down');
        } else {
          $(_this).toggleClass('icon-arrow-up');
          return $(_this).toggleClass('icon-arrow-down');
        }
      };
    })(this));
  });
  figures = $('figure.post');
  loaders = figures.find('.loader');
  images = document.querySelectorAll('figure.post > img');
  showImg = function(image) {
    image.parentElement.firstElementChild.style.display = 'none';
    return image.style.display = 'inline';
  };
  for (i = 0, len = images.length; i < len; i++) {
    image = images[i];
    showImg(image);
  }
  figures.on('mousemove', function(e) {
    var img, offset, x, y;
    offset = $(this).offset();
    x = -(e.pageX - offset.left) / 20;
    y = -(e.pageY - offset.top) / 20;
    img = $(this).find('img');
    return img.css({
      left: x + 'px',
      top: y + 'px'
    });
  });
  figures.on('click', function() {
    var caption, figHeight, figWidth, img, imgRatio, minHeight, minWidth, offset, winHeight, winRatio, winWidth;
    img = $(this).find('img');
    caption = $(this).find('figcaption');
    offset = this.getBoundingClientRect();
    popup.addClass('fullscreen');
    popupFig.append(caption.clone());
    popupImg.attr('src', img.attr('src'));
    popup.animate({
      opacity: 1
    }, 500);
    popupFig.css({
      top: offset.top,
      left: offset.left,
      width: $(this).width(),
      height: $(this).height()
    });
    popupImg.css({
      width: img.width(),
      margin: img.css('margin'),
      opacity: 1
    });
    winWidth = window.innerWidth;
    winHeight = window.innerHeight;
    winRatio = winHeight / winWidth;
    imgRatio = img.outerHeight() / img.outerWidth();
    if (winRatio < imgRatio) {
      figWidth = winWidth * (winRatio / imgRatio);
    } else {
      figWidth = winWidth;
    }
    figHeight = figWidth * imgRatio;
    minWidth = Math.min(popupImg.outerWidth(), figWidth);
    minHeight = Math.min(popupImg.outerHeight(), figHeight);
    popupFig.animate({
      top: window.innerHeight / 2 - minHeight / 2,
      left: window.innerWidth / 2 - minWidth / 2,
      width: minWidth,
      height: minHeight
    }, 500);
    popupImg.animate({
      margin: 0,
      width: minWidth
    }, 500, function() {
      var initFigCSS, popupImgCSS;
      initFigCSS = {
        position: 'static',
        top: 'auto',
        left: 'auto',
        height: 'auto'
      };
      popupImgCSS = {
        width: '100%'
      };
      popupFig.css(initFigCSS);
      popupImg.css(popupImgCSS);
      return popupFig.animate({
        width: figWidth
      }, 500, function() {
        return popupFig.css({
          position: 'relative'
        });
      });
    });
    $(window).on('resize', function() {
      winRatio = $(this).innerHeight() / $(this).innerWidth();
      figWidth = $(this).innerWidth() * (winRatio / imgRatio);
      popupFig.css({
        width: figWidth
      });
      return caption.outerWidth(figWidth);
    });
    return popup.on('click', function() {
      var initImgCSS;
      $(this).removeClass('fullscreen');
      caption.hide();
      $(this).css('opacity', 0);
      $(this).find('figcaption').remove();
      initImgCSS = {
        opacity: 0
      };
      popupImg.css(initImgCSS);
      popupFig.css('position', 'absolute');
      popupImg.attr('src', '');
      showBtn.removeClass('icon-arrow-up');
      return popupNav.hide();
    });
  });
  popup = $('.popup');
  popupFig = popup.find('figure');
  popupImg = popup.find('img');
  popupNav = popup.find('nav');
  popupNav.hide();
  popupNav.on('click', function() {
    return false;
  });
  closeBtn = popupNav.find('.icon-close');
  showBtn = popupNav.find('.icon-arrow-down');
  closeBtn.on('click', function() {
    return popup.click();
  });
  showBtn.on('click', function() {
    var caption, imgHeight, navHeight;
    caption = popup.find('figcaption');
    imgHeight = popupImg.outerHeight();
    navHeight = $(this).parent().outerHeight();
    caption.outerHeight(imgHeight - navHeight);
    caption.css('top', navHeight);
    caption.slideToggle(500);
    $(this).toggleClass('icon-arrow-up');
    caption.on('click', function(e) {
      return e.stopImmediatePropagation();
    });
    return $(window).on('resize', function() {
      imgHeight = popupImg.outerHeight();
      navHeight = popupNav.outerHeight();
      caption.outerHeight(imgHeight - navHeight);
      return caption.css('top', navHeight);
    });
  });
  return popupImg.on('click', function(e) {
    popupNav.fadeToggle(500);
    return e.stopImmediatePropagation();
  });
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlcyI6WyJhcHAuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLENBQUEsQ0FBRSxTQUFBO0FBR0UsTUFBQTtFQUFBLElBQUEsR0FBTyxDQUFBLENBQUUsTUFBRjtFQUNQLE1BQUEsR0FBUyxDQUFBLENBQUUsUUFBRjtFQUNULE9BQUEsR0FBVSxNQUFNLENBQUMsSUFBUCxDQUFZLGtCQUFaO0VBQ1YsT0FBQSxHQUFVLENBQUEsQ0FBRSxVQUFGO0VBRVYsT0FBTyxDQUFDLEVBQVIsQ0FBVyxPQUFYLEVBQW9CLFNBQUE7V0FDaEIsT0FBTyxDQUFDLFdBQVIsQ0FBb0IsR0FBcEIsRUFBeUIsQ0FBQSxTQUFBLEtBQUE7YUFBQSxTQUFBO1FBQ3JCLElBQUcsT0FBTyxDQUFDLEVBQVIsQ0FBVyxVQUFYLENBQUg7VUFDSSxDQUFBLENBQUUsS0FBRixDQUFJLENBQUMsV0FBTCxDQUFpQixlQUFqQjtpQkFDQSxDQUFBLENBQUUsS0FBRixDQUFJLENBQUMsV0FBTCxDQUFpQixpQkFBakIsRUFGSjtTQUFBLE1BQUE7VUFJSSxDQUFBLENBQUUsS0FBRixDQUFJLENBQUMsV0FBTCxDQUFpQixlQUFqQjtpQkFDQSxDQUFBLENBQUUsS0FBRixDQUFJLENBQUMsV0FBTCxDQUFpQixpQkFBakIsRUFMSjs7TUFEcUI7SUFBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQXpCO0VBRGdCLENBQXBCO0VBU0EsT0FBQSxHQUFVLENBQUEsQ0FBRSxhQUFGO0VBQ1YsT0FBQSxHQUFVLE9BQU8sQ0FBQyxJQUFSLENBQWEsU0FBYjtFQUVWLE1BQUEsR0FBUyxRQUFRLENBQUMsZ0JBQVQsQ0FBMEIsbUJBQTFCO0VBQ1QsT0FBQSxHQUFVLFNBQUMsS0FBRDtJQUNOLEtBQUssQ0FBQyxhQUFhLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLE9BQTVDLEdBQXNEO1dBQ3RELEtBQUssQ0FBQyxLQUFLLENBQUMsT0FBWixHQUFzQjtFQUZoQjtBQUlWLE9BQUEsd0NBQUE7O0lBQUEsT0FBQSxDQUFRLEtBQVI7QUFBQTtFQWFBLE9BQU8sQ0FBQyxFQUFSLENBQVcsV0FBWCxFQUF3QixTQUFDLENBQUQ7QUFDcEIsUUFBQTtJQUFBLE1BQUEsR0FBUyxDQUFBLENBQUUsSUFBRixDQUFJLENBQUMsTUFBTCxDQUFBO0lBQ1QsQ0FBQSxHQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBRixHQUFVLE1BQU0sQ0FBQyxJQUFsQixDQUFELEdBQXlCO0lBQzdCLENBQUEsR0FBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUYsR0FBVSxNQUFNLENBQUMsR0FBbEIsQ0FBRCxHQUF3QjtJQUU1QixHQUFBLEdBQU0sQ0FBQSxDQUFFLElBQUYsQ0FBSSxDQUFDLElBQUwsQ0FBVSxLQUFWO1dBQ04sR0FBRyxDQUFDLEdBQUosQ0FDSTtNQUFBLElBQUEsRUFBTSxDQUFBLEdBQUksSUFBVjtNQUNBLEdBQUEsRUFBSyxDQUFBLEdBQUksSUFEVDtLQURKO0VBTm9CLENBQXhCO0VBV0EsT0FBTyxDQUFDLEVBQVIsQ0FBVyxPQUFYLEVBQW9CLFNBQUE7QUFDaEIsUUFBQTtJQUFBLEdBQUEsR0FBTSxDQUFBLENBQUUsSUFBRixDQUFJLENBQUMsSUFBTCxDQUFVLEtBQVY7SUFDTixPQUFBLEdBQVUsQ0FBQSxDQUFFLElBQUYsQ0FBSSxDQUFDLElBQUwsQ0FBVSxZQUFWO0lBQ1YsTUFBQSxHQUFTLElBQUMsQ0FBQSxxQkFBRCxDQUFBO0lBQ1QsS0FBSyxDQUFDLFFBQU4sQ0FBZSxZQUFmO0lBQ0EsUUFBUSxDQUFDLE1BQVQsQ0FBZ0IsT0FBTyxDQUFDLEtBQVIsQ0FBQSxDQUFoQjtJQUNBLFFBQVEsQ0FBQyxJQUFULENBQWMsS0FBZCxFQUFxQixHQUFHLENBQUMsSUFBSixDQUFTLEtBQVQsQ0FBckI7SUFDQSxLQUFLLENBQUMsT0FBTixDQUNJO01BQUEsT0FBQSxFQUFTLENBQVQ7S0FESixFQUVJLEdBRko7SUFHQSxRQUFRLENBQUMsR0FBVCxDQUNJO01BQUEsR0FBQSxFQUFLLE1BQU0sQ0FBQyxHQUFaO01BQ0EsSUFBQSxFQUFNLE1BQU0sQ0FBQyxJQURiO01BRUEsS0FBQSxFQUFPLENBQUEsQ0FBRSxJQUFGLENBQUksQ0FBQyxLQUFMLENBQUEsQ0FGUDtNQUdBLE1BQUEsRUFBUSxDQUFBLENBQUUsSUFBRixDQUFJLENBQUMsTUFBTCxDQUFBLENBSFI7S0FESjtJQUtBLFFBQVEsQ0FBQyxHQUFULENBQ0k7TUFBQSxLQUFBLEVBQU8sR0FBRyxDQUFDLEtBQUosQ0FBQSxDQUFQO01BQ0EsTUFBQSxFQUFRLEdBQUcsQ0FBQyxHQUFKLENBQVEsUUFBUixDQURSO01BRUEsT0FBQSxFQUFTLENBRlQ7S0FESjtJQUtBLFFBQUEsR0FBVyxNQUFNLENBQUM7SUFDbEIsU0FBQSxHQUFZLE1BQU0sQ0FBQztJQUNuQixRQUFBLEdBQVksU0FBQSxHQUFZO0lBQ3hCLFFBQUEsR0FBVyxHQUFHLENBQUMsV0FBSixDQUFBLENBQUEsR0FBb0IsR0FBRyxDQUFDLFVBQUosQ0FBQTtJQUkvQixJQUFHLFFBQUEsR0FBVyxRQUFkO01BQ0ksUUFBQSxHQUFXLFFBQUEsR0FBUyxDQUFDLFFBQUEsR0FBUyxRQUFWLEVBRHhCO0tBQUEsTUFBQTtNQUdJLFFBQUEsR0FBVyxTQUhmOztJQUtBLFNBQUEsR0FBWSxRQUFBLEdBQVM7SUFHckIsUUFBQSxHQUFXLElBQUksQ0FBQyxHQUFMLENBQVMsUUFBUSxDQUFDLFVBQVQsQ0FBQSxDQUFULEVBQWdDLFFBQWhDO0lBQ1gsU0FBQSxHQUFZLElBQUksQ0FBQyxHQUFMLENBQVMsUUFBUSxDQUFDLFdBQVQsQ0FBQSxDQUFULEVBQWlDLFNBQWpDO0lBQ1osUUFBUSxDQUFDLE9BQVQsQ0FDSTtNQUFBLEdBQUEsRUFBSyxNQUFNLENBQUMsV0FBUCxHQUFtQixDQUFuQixHQUF1QixTQUFBLEdBQVUsQ0FBdEM7TUFDQSxJQUFBLEVBQU0sTUFBTSxDQUFDLFVBQVAsR0FBa0IsQ0FBbEIsR0FBc0IsUUFBQSxHQUFTLENBRHJDO01BRUEsS0FBQSxFQUFPLFFBRlA7TUFHQSxNQUFBLEVBQVEsU0FIUjtLQURKLEVBS0ksR0FMSjtJQU1BLFFBQVEsQ0FBQyxPQUFULENBQ0k7TUFBQSxNQUFBLEVBQVEsQ0FBUjtNQUNBLEtBQUEsRUFBTyxRQURQO0tBREosRUFHSSxHQUhKLEVBSUksU0FBQTtBQUVJLFVBQUE7TUFBQSxVQUFBLEdBQ0k7UUFBQSxRQUFBLEVBQVUsUUFBVjtRQUNBLEdBQUEsRUFBSyxNQURMO1FBRUEsSUFBQSxFQUFNLE1BRk47UUFHQSxNQUFBLEVBQVEsTUFIUjs7TUFJSixXQUFBLEdBQ0k7UUFBQSxLQUFBLEVBQU8sTUFBUDs7TUFDSixRQUFRLENBQUMsR0FBVCxDQUFhLFVBQWI7TUFDQSxRQUFRLENBQUMsR0FBVCxDQUFhLFdBQWI7YUFDQSxRQUFRLENBQUMsT0FBVCxDQUNJO1FBQUEsS0FBQSxFQUFPLFFBQVA7T0FESixFQUVJLEdBRkosRUFHSSxTQUFBO2VBQ0ksUUFBUSxDQUFDLEdBQVQsQ0FDSTtVQUFBLFFBQUEsRUFBVSxVQUFWO1NBREo7TUFESixDQUhKO0lBWEosQ0FKSjtJQXVCQSxDQUFBLENBQUUsTUFBRixDQUFTLENBQUMsRUFBVixDQUFhLFFBQWIsRUFBdUIsU0FBQTtNQUNuQixRQUFBLEdBQVcsQ0FBQSxDQUFFLElBQUYsQ0FBSSxDQUFDLFdBQUwsQ0FBQSxDQUFBLEdBQXFCLENBQUEsQ0FBRSxJQUFGLENBQUksQ0FBQyxVQUFMLENBQUE7TUFDaEMsUUFBQSxHQUFXLENBQUEsQ0FBRSxJQUFGLENBQUksQ0FBQyxVQUFMLENBQUEsQ0FBQSxHQUFvQixDQUFDLFFBQUEsR0FBUyxRQUFWO01BQy9CLFFBQVEsQ0FBQyxHQUFULENBQ0k7UUFBQSxLQUFBLEVBQU8sUUFBUDtPQURKO2FBRUEsT0FBTyxDQUFDLFVBQVIsQ0FBbUIsUUFBbkI7SUFMbUIsQ0FBdkI7V0FRQSxLQUFLLENBQUMsRUFBTixDQUFTLE9BQVQsRUFBa0IsU0FBQTtBQUNkLFVBQUE7TUFBQSxDQUFBLENBQUUsSUFBRixDQUFJLENBQUMsV0FBTCxDQUFpQixZQUFqQjtNQUNBLE9BQU8sQ0FBQyxJQUFSLENBQUE7TUFDQSxDQUFBLENBQUUsSUFBRixDQUFJLENBQUMsR0FBTCxDQUFTLFNBQVQsRUFBb0IsQ0FBcEI7TUFDQSxDQUFBLENBQUUsSUFBRixDQUFJLENBQUMsSUFBTCxDQUFVLFlBQVYsQ0FBdUIsQ0FBQyxNQUF4QixDQUFBO01BQ0EsVUFBQSxHQUNJO1FBQUEsT0FBQSxFQUFTLENBQVQ7O01BQ0osUUFBUSxDQUFDLEdBQVQsQ0FBYSxVQUFiO01BQ0EsUUFBUSxDQUFDLEdBQVQsQ0FBYSxVQUFiLEVBQXlCLFVBQXpCO01BQ0EsUUFBUSxDQUFDLElBQVQsQ0FBYyxLQUFkLEVBQXFCLEVBQXJCO01BQ0EsT0FBTyxDQUFDLFdBQVIsQ0FBb0IsZUFBcEI7YUFDQSxRQUFRLENBQUMsSUFBVCxDQUFBO0lBWGMsQ0FBbEI7RUExRWdCLENBQXBCO0VBdUZBLEtBQUEsR0FBUSxDQUFBLENBQUUsUUFBRjtFQUVSLFFBQUEsR0FBVyxLQUFLLENBQUMsSUFBTixDQUFXLFFBQVg7RUFDWCxRQUFBLEdBQVcsS0FBSyxDQUFDLElBQU4sQ0FBVyxLQUFYO0VBQ1gsUUFBQSxHQUFXLEtBQUssQ0FBQyxJQUFOLENBQVcsS0FBWDtFQUNYLFFBQVEsQ0FBQyxJQUFULENBQUE7RUFDQSxRQUFRLENBQUMsRUFBVCxDQUFZLE9BQVosRUFBcUIsU0FBQTtXQUNqQjtFQURpQixDQUFyQjtFQUVBLFFBQUEsR0FBVyxRQUFRLENBQUMsSUFBVCxDQUFjLGFBQWQ7RUFDWCxPQUFBLEdBQVUsUUFBUSxDQUFDLElBQVQsQ0FBYyxrQkFBZDtFQUdWLFFBQVEsQ0FBQyxFQUFULENBQVksT0FBWixFQUFxQixTQUFBO1dBQ2pCLEtBQUssQ0FBQyxLQUFOLENBQUE7RUFEaUIsQ0FBckI7RUFJQSxPQUFPLENBQUMsRUFBUixDQUFXLE9BQVgsRUFBb0IsU0FBQTtBQUNoQixRQUFBO0lBQUEsT0FBQSxHQUFVLEtBQUssQ0FBQyxJQUFOLENBQVcsWUFBWDtJQUNWLFNBQUEsR0FBWSxRQUFRLENBQUMsV0FBVCxDQUFBO0lBQ1osU0FBQSxHQUFZLENBQUEsQ0FBRSxJQUFGLENBQUksQ0FBQyxNQUFMLENBQUEsQ0FBYSxDQUFDLFdBQWQsQ0FBQTtJQUNaLE9BQU8sQ0FBQyxXQUFSLENBQW9CLFNBQUEsR0FBWSxTQUFoQztJQUNBLE9BQU8sQ0FBQyxHQUFSLENBQVksS0FBWixFQUFtQixTQUFuQjtJQUNBLE9BQU8sQ0FBQyxXQUFSLENBQW9CLEdBQXBCO0lBQ0EsQ0FBQSxDQUFFLElBQUYsQ0FBSSxDQUFDLFdBQUwsQ0FBaUIsZUFBakI7SUFFQSxPQUFPLENBQUMsRUFBUixDQUFXLE9BQVgsRUFBb0IsU0FBQyxDQUFEO2FBQ2hCLENBQUMsQ0FBQyx3QkFBRixDQUFBO0lBRGdCLENBQXBCO1dBR0EsQ0FBQSxDQUFFLE1BQUYsQ0FBUyxDQUFDLEVBQVYsQ0FBYSxRQUFiLEVBQXVCLFNBQUE7TUFDbkIsU0FBQSxHQUFZLFFBQVEsQ0FBQyxXQUFULENBQUE7TUFDWixTQUFBLEdBQVksUUFBUSxDQUFDLFdBQVQsQ0FBQTtNQUNaLE9BQU8sQ0FBQyxXQUFSLENBQW9CLFNBQUEsR0FBWSxTQUFoQzthQUNBLE9BQU8sQ0FBQyxHQUFSLENBQVksS0FBWixFQUFtQixTQUFuQjtJQUptQixDQUF2QjtFQVpnQixDQUFwQjtTQW9CQSxRQUFRLENBQUMsRUFBVCxDQUFZLE9BQVosRUFBcUIsU0FBQyxDQUFEO0lBQ2pCLFFBQVEsQ0FBQyxVQUFULENBQW9CLEdBQXBCO1dBQ0EsQ0FBQyxDQUFDLHdCQUFGLENBQUE7RUFGaUIsQ0FBckI7QUE1S0YsQ0FBRiIsInNvdXJjZXNDb250ZW50IjpbIiQgLT5cblxuICAgICMgc2hvdy9oaWRlIG5hdiBtZW51IGJhclxuICAgIGJvZHkgPSAkKCdib2R5JylcbiAgICBoZWFkZXIgPSAkKCdoZWFkZXInKVxuICAgIG1lbnVCdG4gPSBoZWFkZXIuZmluZCAnLmljb24tYXJyb3ctZG93bidcbiAgICBuYXZNZW51ID0gJCgnbmF2Lm1lbnUnKVxuXG4gICAgbWVudUJ0bi5vbiAnY2xpY2snLCAtPlxuICAgICAgICBuYXZNZW51LnNsaWRlVG9nZ2xlIDUwMCwgPT5cbiAgICAgICAgICAgIGlmIG5hdk1lbnUuaXMoJzp2aXNpYmxlJylcbiAgICAgICAgICAgICAgICAkKEApLnRvZ2dsZUNsYXNzKCdpY29uLWFycm93LXVwJylcbiAgICAgICAgICAgICAgICAkKEApLnRvZ2dsZUNsYXNzKCdpY29uLWFycm93LWRvd24nKVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICQoQCkudG9nZ2xlQ2xhc3MoJ2ljb24tYXJyb3ctdXAnKVxuICAgICAgICAgICAgICAgICQoQCkudG9nZ2xlQ2xhc3MoJ2ljb24tYXJyb3ctZG93bicpXG4gICAgXG4gICAgZmlndXJlcyA9ICQoJ2ZpZ3VyZS5wb3N0JylcbiAgICBsb2FkZXJzID0gZmlndXJlcy5maW5kICcubG9hZGVyJ1xuICAgICMgaW1hZ2VzID0gZmlndXJlcy5maW5kICdpbWcnXG4gICAgaW1hZ2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCAnZmlndXJlLnBvc3QgPiBpbWcnXG4gICAgc2hvd0ltZyA9IChpbWFnZSkgLT5cbiAgICAgICAgaW1hZ2UucGFyZW50RWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnXG4gICAgICAgIGltYWdlLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lJ1xuXG4gICAgc2hvd0ltZyhpbWFnZSkgZm9yIGltYWdlIGluIGltYWdlc1xuXG4gICAgIyBib2R5Lm9uICdsb2FkJywgLT5cbiAgICAjICAgICBmaWd1cmVzID0gJCgnZmlndXJlLnBvc3QnKVxuICAgICMgICAgIGxvYWRlcnMgPSBmaWd1cmVzLmZpbmQgJy5sb2FkZXInXG4gICAgIyAgICAgaW1hZ2VzID0gZmlndXJlcy5maW5kICdpbWcnXG5cbiAgICAjIGltYWdlcy5vbiAnbG9hZCcsIC0+XG4gICAgIyAgICAgJChAKS5wcmV2KCkuaGlkZSgpXG4gICAgIyAgICAgJChAKS5mYWRlSW4gNTAwXG5cblxuICAgICMgbW92ZSBpbWFnZSBvbiBtb3VzZW1vdmVcbiAgICBmaWd1cmVzLm9uICdtb3VzZW1vdmUnLCAoZSkgLT5cbiAgICAgICAgb2Zmc2V0ID0gJChAKS5vZmZzZXQoKVxuICAgICAgICB4ID0gLShlLnBhZ2VYIC0gb2Zmc2V0LmxlZnQpLzIwXG4gICAgICAgIHkgPSAtKGUucGFnZVkgLSBvZmZzZXQudG9wKS8yMFxuXG4gICAgICAgIGltZyA9ICQoQCkuZmluZCAnaW1nJ1xuICAgICAgICBpbWcuY3NzXG4gICAgICAgICAgICBsZWZ0OiB4ICsgJ3B4J1xuICAgICAgICAgICAgdG9wOiB5ICsgJ3B4J1xuXG4gICAgIyBzaG93IGltYWdlIG9uIGZ1bGxzY3JlZW5cbiAgICBmaWd1cmVzLm9uICdjbGljaycsIC0+XG4gICAgICAgIGltZyA9ICQoQCkuZmluZCAnaW1nJ1xuICAgICAgICBjYXB0aW9uID0gJChAKS5maW5kICdmaWdjYXB0aW9uJ1xuICAgICAgICBvZmZzZXQgPSBAZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICAgICAgcG9wdXAuYWRkQ2xhc3MoJ2Z1bGxzY3JlZW4nKVxuICAgICAgICBwb3B1cEZpZy5hcHBlbmQgY2FwdGlvbi5jbG9uZSgpXG4gICAgICAgIHBvcHVwSW1nLmF0dHIoJ3NyYycsIGltZy5hdHRyKCdzcmMnKSlcbiAgICAgICAgcG9wdXAuYW5pbWF0ZVxuICAgICAgICAgICAgb3BhY2l0eTogMVxuICAgICAgICAgICAgNTAwXG4gICAgICAgIHBvcHVwRmlnLmNzc1xuICAgICAgICAgICAgdG9wOiBvZmZzZXQudG9wXG4gICAgICAgICAgICBsZWZ0OiBvZmZzZXQubGVmdFxuICAgICAgICAgICAgd2lkdGg6ICQoQCkud2lkdGgoKVxuICAgICAgICAgICAgaGVpZ2h0OiAkKEApLmhlaWdodCgpXG4gICAgICAgIHBvcHVwSW1nLmNzc1xuICAgICAgICAgICAgd2lkdGg6IGltZy53aWR0aCgpXG4gICAgICAgICAgICBtYXJnaW46IGltZy5jc3MoJ21hcmdpbicpXG4gICAgICAgICAgICBvcGFjaXR5OiAxXG5cbiAgICAgICAgd2luV2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aFxuICAgICAgICB3aW5IZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHRcbiAgICAgICAgd2luUmF0aW8gPSAgd2luSGVpZ2h0IC8gd2luV2lkdGhcbiAgICAgICAgaW1nUmF0aW8gPSBpbWcub3V0ZXJIZWlnaHQoKSAvIGltZy5vdXRlcldpZHRoKClcblxuICAgICAgICAjICQoJ3Aud2lkdGgnKS50ZXh0KHdpbmRvdy5pbm5lcldpZHRoICsgJyAnICsgd2luV2lkdGgpXG5cbiAgICAgICAgaWYgd2luUmF0aW8gPCBpbWdSYXRpb1xuICAgICAgICAgICAgZmlnV2lkdGggPSB3aW5XaWR0aCood2luUmF0aW8vaW1nUmF0aW8pXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGZpZ1dpZHRoID0gd2luV2lkdGhcblxuICAgICAgICBmaWdIZWlnaHQgPSBmaWdXaWR0aCppbWdSYXRpb1xuXG4gICAgICAgICMgYW5pbWFjamEgcHJ6ZXN1d2FuaWEgaSBwb3dpxJlrc3phbmlhIGtsaWtuacSZdGVnbyBvYnJhemthXG4gICAgICAgIG1pbldpZHRoID0gTWF0aC5taW4ocG9wdXBJbWcub3V0ZXJXaWR0aCgpLCBmaWdXaWR0aClcbiAgICAgICAgbWluSGVpZ2h0ID0gTWF0aC5taW4ocG9wdXBJbWcub3V0ZXJIZWlnaHQoKSwgZmlnSGVpZ2h0KVxuICAgICAgICBwb3B1cEZpZy5hbmltYXRlXG4gICAgICAgICAgICB0b3A6IHdpbmRvdy5pbm5lckhlaWdodC8yIC0gbWluSGVpZ2h0LzJcbiAgICAgICAgICAgIGxlZnQ6IHdpbmRvdy5pbm5lcldpZHRoLzIgLSBtaW5XaWR0aC8yXG4gICAgICAgICAgICB3aWR0aDogbWluV2lkdGhcbiAgICAgICAgICAgIGhlaWdodDogbWluSGVpZ2h0XG4gICAgICAgICAgICA1MDBcbiAgICAgICAgcG9wdXBJbWcuYW5pbWF0ZVxuICAgICAgICAgICAgbWFyZ2luOiAwXG4gICAgICAgICAgICB3aWR0aDogbWluV2lkdGhcbiAgICAgICAgICAgIDUwMFxuICAgICAgICAgICAgLT5cbiAgICAgICAgICAgICAgICAjIGRlYnVnZ2VyXG4gICAgICAgICAgICAgICAgaW5pdEZpZ0NTUyA9XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAnc3RhdGljJ1xuICAgICAgICAgICAgICAgICAgICB0b3A6ICdhdXRvJ1xuICAgICAgICAgICAgICAgICAgICBsZWZ0OiAnYXV0bydcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAnYXV0bydcbiAgICAgICAgICAgICAgICBwb3B1cEltZ0NTUyA9XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiAnMTAwJSdcbiAgICAgICAgICAgICAgICBwb3B1cEZpZy5jc3MgaW5pdEZpZ0NTU1xuICAgICAgICAgICAgICAgIHBvcHVwSW1nLmNzcyBwb3B1cEltZ0NTU1xuICAgICAgICAgICAgICAgIHBvcHVwRmlnLmFuaW1hdGVcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGZpZ1dpZHRoXG4gICAgICAgICAgICAgICAgICAgIDUwMFxuICAgICAgICAgICAgICAgICAgICAtPlxuICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXBGaWcuY3NzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICdyZWxhdGl2ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIMW8ZWJ5IGfDs3JueSBwYXNlayBpIG9waXMgYnnFgnkgd2Ugd8WCYcWbY2l3eW0gbWllanNjdVxuXG4gICAgICAgICQod2luZG93KS5vbiAncmVzaXplJywgLT5cbiAgICAgICAgICAgIHdpblJhdGlvID0gJChAKS5pbm5lckhlaWdodCgpIC8gJChAKS5pbm5lcldpZHRoKClcbiAgICAgICAgICAgIGZpZ1dpZHRoID0gJChAKS5pbm5lcldpZHRoKCkgKiAod2luUmF0aW8vaW1nUmF0aW8pXG4gICAgICAgICAgICBwb3B1cEZpZy5jc3NcbiAgICAgICAgICAgICAgICB3aWR0aDogZmlnV2lkdGhcbiAgICAgICAgICAgIGNhcHRpb24ub3V0ZXJXaWR0aChmaWdXaWR0aClcbiAgICAgICAgICAgICAgICAjIHBvcHJhd2thIHJlc3BvbnN5d25vxZtjaTogc3plcm9rb8WbxIcgb2JyYXprYVxuXG4gICAgICAgIHBvcHVwLm9uICdjbGljaycsIC0+XG4gICAgICAgICAgICAkKEApLnJlbW92ZUNsYXNzKCdmdWxsc2NyZWVuJylcbiAgICAgICAgICAgIGNhcHRpb24uaGlkZSgpXG4gICAgICAgICAgICAkKEApLmNzcygnb3BhY2l0eScsIDApXG4gICAgICAgICAgICAkKEApLmZpbmQoJ2ZpZ2NhcHRpb24nKS5yZW1vdmUoKVxuICAgICAgICAgICAgaW5pdEltZ0NTUyA9XG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMFxuICAgICAgICAgICAgcG9wdXBJbWcuY3NzIGluaXRJbWdDU1NcbiAgICAgICAgICAgIHBvcHVwRmlnLmNzcyAncG9zaXRpb24nLCAnYWJzb2x1dGUnXG4gICAgICAgICAgICBwb3B1cEltZy5hdHRyICdzcmMnLCAnJ1xuICAgICAgICAgICAgc2hvd0J0bi5yZW1vdmVDbGFzcyAnaWNvbi1hcnJvdy11cCdcbiAgICAgICAgICAgIHBvcHVwTmF2LmhpZGUoKVxuXG4gICAgcG9wdXAgPSAkKCcucG9wdXAnKVxuXG4gICAgcG9wdXBGaWcgPSBwb3B1cC5maW5kICdmaWd1cmUnXG4gICAgcG9wdXBJbWcgPSBwb3B1cC5maW5kICdpbWcnXG4gICAgcG9wdXBOYXYgPSBwb3B1cC5maW5kICduYXYnXG4gICAgcG9wdXBOYXYuaGlkZSgpXG4gICAgcG9wdXBOYXYub24gJ2NsaWNrJywgLT5cbiAgICAgICAgZmFsc2VcbiAgICBjbG9zZUJ0biA9IHBvcHVwTmF2LmZpbmQgJy5pY29uLWNsb3NlJ1xuICAgIHNob3dCdG4gPSBwb3B1cE5hdi5maW5kICcuaWNvbi1hcnJvdy1kb3duJ1xuXG4gICAgIyBleGl0IGZ1bGxzY3JlZW4gbW9kZVxuICAgIGNsb3NlQnRuLm9uICdjbGljaycsIC0+XG4gICAgICAgIHBvcHVwLmNsaWNrKClcblxuICAgICMgdG9nZ2xlIGNhcHRpb24gdmlzaWJpbGl0eVxuICAgIHNob3dCdG4ub24gJ2NsaWNrJywgLT5cbiAgICAgICAgY2FwdGlvbiA9IHBvcHVwLmZpbmQgJ2ZpZ2NhcHRpb24nXG4gICAgICAgIGltZ0hlaWdodCA9IHBvcHVwSW1nLm91dGVySGVpZ2h0KClcbiAgICAgICAgbmF2SGVpZ2h0ID0gJChAKS5wYXJlbnQoKS5vdXRlckhlaWdodCgpXG4gICAgICAgIGNhcHRpb24ub3V0ZXJIZWlnaHQoaW1nSGVpZ2h0IC0gbmF2SGVpZ2h0KVxuICAgICAgICBjYXB0aW9uLmNzcygndG9wJywgbmF2SGVpZ2h0KVxuICAgICAgICBjYXB0aW9uLnNsaWRlVG9nZ2xlIDUwMFxuICAgICAgICAkKEApLnRvZ2dsZUNsYXNzKCdpY29uLWFycm93LXVwJylcblxuICAgICAgICBjYXB0aW9uLm9uICdjbGljaycsIChlKSAtPlxuICAgICAgICAgICAgZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKVxuXG4gICAgICAgICQod2luZG93KS5vbiAncmVzaXplJywgLT5cbiAgICAgICAgICAgIGltZ0hlaWdodCA9IHBvcHVwSW1nLm91dGVySGVpZ2h0KClcbiAgICAgICAgICAgIG5hdkhlaWdodCA9IHBvcHVwTmF2Lm91dGVySGVpZ2h0KClcbiAgICAgICAgICAgIGNhcHRpb24ub3V0ZXJIZWlnaHQoaW1nSGVpZ2h0IC0gbmF2SGVpZ2h0KVxuICAgICAgICAgICAgY2FwdGlvbi5jc3MoJ3RvcCcsIG5hdkhlaWdodClcbiAgICAgICAgICAgICMgcG9wcmF3a2EgcmVzcG9uc3l3bm/Fm2NpIGRsYSBnw7NybmVqIGJlbGtpIGkgb3Bpc3VcblxuXG4gICAgcG9wdXBJbWcub24gJ2NsaWNrJywgKGUpIC0+XG4gICAgICAgIHBvcHVwTmF2LmZhZGVUb2dnbGUgNTAwXG4gICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKClcbiJdfQ==
